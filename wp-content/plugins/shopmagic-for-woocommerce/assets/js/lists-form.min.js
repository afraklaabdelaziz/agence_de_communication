var c=(a,e,s)=>new Promise((i,n)=>{var d=r=>{try{t(s.next(r))}catch(o){n(o)}},l=r=>{try{t(s.throw(r))}catch(o){n(o)}},t=r=>r.done?i(r.value):Promise.resolve(r.value).then(d,l);t((s=s.apply(a,e)).next())});var{__:g}=wp.i18n,m=class{constructor(e){this.handle=e=>c(this,null,function*(){e.preventDefault(),this.messageContainer.classList.add("hide");let s=yield fetch(shopmagic_form.ajax_url,{method:"POST",body:new FormData(this.form)});if(!s.ok){this.displayError(g("An error occurred during form submission. Try again later.","shopmagic-for-woocommerce"));return}let i=yield s.json();if(i.success){typeof i.data=="string"&&this.displaySuccess(i.data);return}typeof i.data=="string"&&this.displayError(i.data)});let s=document.querySelector(e);if(!(s instanceof HTMLFormElement))throw new Error("Invalid element. Must be <form>");this.form=s;let i=this.form.querySelector(".shopmagic-message");if(!i)throw new Error("Missing message container with class `.shopmagic-message`");this.messageContainer=i}init(){this.form.addEventListener("submit",this.handle)}displaySuccess(e){this.displayMessage(e,"success")}displayError(e){this.displayMessage(e,"error")}displayMessage(e,s){s==="success"?(this.messageContainer.classList.remove("error"),this.messageContainer.classList.add("success")):(this.messageContainer.classList.remove("success"),this.messageContainer.classList.add("error")),this.messageContainer.innerText=e,this.messageContainer.classList.remove("hide")}};window.ShopMagic=window.ShopMagic||{};window.ShopMagic.shortcodeForm=a=>{new m(a).init()};
