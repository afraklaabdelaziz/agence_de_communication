var zbscrmjsCustomerFilterRetrieving=!1,zbscrmjsCustomerFilterHasRetrieved=!1;function zbscrmJS_customfilters_bindDateRange(t){jQuery(t).daterangepicker({autoUpdateInput:!1,locale:{format:"DD.MM.YYYY",cancelLabel:"Clear"},ranges:{Today:[moment(),moment()],Yesterday:[moment().subtract(1,"days"),moment().subtract(1,"days")],"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]}},zbsJSFilterDateRangeCallback),jQuery(t).on("cancel.daterangepicker",function(t,e){jQuery(this).val(""),zbsJSFilterDateRangeClear()})}function zbscrmJS_customfilters_bindAjaxButton(e,t,r,s){jQuery(t).off("click").on("click",function(){var t;window.zbscrmjsCustomerFilterRetrieving||(window.zbscrmjsCustomerFilterRetrieving=!0,jQuery(e+" .zbs-crm-customerfilter-ajax-output").show().html('<i class="fa fa-circle-o-notch fa-spin"></i>'),window.zbscrmjs_mailExt_CustomerFiltersInEffect="none",t={action:"filterCustomers",sec:window.zbscrmjs_secToken},jQuery(e+" :input, "+e+" select").each(function(){("checkbox"!=jQuery(this).attr("type")||jQuery(this).attr("checked"))&&(t[this.name]=jQuery(this).val())}),jQuery.ajax({type:"POST",url:ajaxurl,data:t,dataType:"json",timeout:2e4,success:function(t){window.zbscrmjsCustomerFilterRetrieving=!1,void 0!==t.count?(jQuery(e+" .zbs-crm-customerfilter-ajax-output").html('<i class="fa fa-users"></i> <strong>'+t.count+"</strong> Customers Found"),"function"==typeof r&&r(t)):jQuery(e+" .zbs-crm-customerfilter-ajax-output").html('<i class="fa fa-user-times"></i> No customers found matching these filters')},error:function(t){console.error("RESPONSE",t),window.zbscrmjsCustomerFilterHasRetrieved?(window.zbscrmjsCustomerFilterRetrieving=!1,"function"==typeof s&&s(t),jQuery(e+" .zbs-crm-customerfilter-ajax-output").html('<i class="fa fa-user-times"></i> Error Retrieving Customers')):(window.zbscrmjsCustomerFilterHasRetrieved=!0,window.zbscrmjsCustomerFilterRetrieving=!1,"function"==typeof s&&s(t),jQuery(e+" .zbs-crm-customerfilter-ajax-output").html("<i class=\"fa fa-tachometer\"></i> It's taking some time to retrieve your customers.<br />If you have a large database of customers, this initial query can take some time.<br /><strong>Please try again in a few minutes</strong>, (after your customers are cached, this'll be fast!)"))}}))})}function zbsJSFilterDateRangeCallback(t,e){jQuery("#zbs-crm-customerfilter-addedrange-reportrange span").html(t.format("MMMM D, YYYY")+" - "+e.format("MMMM D, YYYY")),jQuery("#zbs-crm-customerfilter-addedrange").val(t.format("MMMM D, YYYY")+" - "+e.format("MMMM D, YYYY"))}function zbsJSFilterDateRangeClear(){jQuery("#zbs-crm-customerfilter-addedrange-reportrange span").html(""),jQuery("#zbs-crm-customerfilter-addedrange").val("")}