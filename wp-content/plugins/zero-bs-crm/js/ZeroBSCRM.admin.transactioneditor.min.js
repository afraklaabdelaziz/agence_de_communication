function zbscrmjs_transaction_unsetCustomer(n){void 0!==n&&""!=n||(jQuery("#customer").val(""),jQuery("#customer_name").val(""),jQuery(".assignInvToCust, #invoiceFieldWrap").hide(),setTimeout(function(){zeroBSCRMJS_showContactLinkIf("")},0))}function zbscrmjs_transaction_unsetCompany(n){void 0!==n&&""!=n||(jQuery("#zbsct_company").val(""),setTimeout(function(){zeroBSCRMJS_showCompanyLinkIf("")},0))}function zbscrmjs_transaction_setCustomer(n){void 0!==n.id?(jQuery("#customer").val(n.id),jQuery("#customer_name").val(n.name),zbscrmjs_build_custInv_dropdown(n.id)):(jQuery("#customer").val(""),jQuery("#customer_name").val("")),setTimeout(function(){zeroBSCRMJS_showContactLinkIf(n.id)},0)}function zbscrmjs_transaction_setCompany(n){void 0!==n.id?jQuery("#zbsct_company").val(n.id):jQuery("#zbsct_company").val(""),setTimeout(function(){zeroBSCRMJS_showCompanyLinkIf(n.id)},0)}function zbscrmjs_build_custInv_dropdown(n,a){var e=jQuery("#invoice_id").val();""!=n?(jQuery("#invoiceFieldWrap").append(zbscrm_js_uiSpinnerBlocker()),zbscrm_js_getCustInvs(n,function(n){var t='<select id="invoice_id" name="invoice_id" class="form-control">';0<n.length?(t+='<option value="" disabled="disabled"',(void 0===a||a<=0)&&(t+=' selected="selected"'),t=(t+=">"+zeroBSCRMJS_transEditLang("selectinv","Select Invoice")+"</option>")+'<option value="">'+zeroBSCRMJS_transEditLang("none","None")+"</option>",jQuery.each(n,function(n,i){var e="",o=-1;2<zbscrm_JS_DAL()?(o=i.id,e="#"+i.id,void 0!==i.id_override&&(e+=" - "+i.id_override)):(o=i.id,void 0!==i.zbsid?e+="#"+i.zbsid:e+="#PID:"+i.id),void 0!==i.meta&&(void 0!==i.meta.val&&(e+=" ("+window.zbs_root.currencyOptions.currencyStr+i.meta.val+")"),void 0!==i.meta.date&&(e+=" - "+i.meta.date)),t+='<option value="'+o+'"',void 0!==a&&o==a&&(t+=' selected="selected"'),t+=">"+e+"</option>"})):t+='<option value="" disabled="disabled" selected="selected">'+zeroBSCRMJS_transEditLang("noinvoices","None Found")+"</option>",t+="</select>",jQuery("#invoiceFieldWrap").html(t),jQuery(".assignInvToCust").show(),setTimeout(function(){zeroBSCRMJS_bindInvSelect()},0)},function(n){jQuery(".assignInvToCust").hide();var i=0==e?"":e;jQuery("#invoiceFieldWrap").html('<input style="max-width:200px;" id="invoice_id" name="invoice_id" value="'+i+'" class="form-control">')})):(jQuery(".assignInvToCust").show(),0==e&&(e=""),jQuery("#invoiceFieldWrap").html('<input style="max-width:200px;" id="invoice_id" name="invoice_id" value="'+e+'" class="form-control">'),setTimeout(function(){zeroBSCRMJS_bindInvSelect()},0))}function zeroBSCRMJS_bindInvSelect(){jQuery("#invoice_id").on("change",function(){zeroBSCRMJS_showInvLinkIf()}),zeroBSCRMJS_showInvLinkIf()}function zeroBSCRMJS_showInvLinkIf(){jQuery("#invoiceSelectionTitle .zbs-view-invoice").remove();var n=jQuery("#invoiceFieldWrap select").val();null!=n&&""!==n&&0<(n=parseInt(n))&&(n=(n='<div class="ui right floated mini animated button zbs-view-invoice" style="margin-left:0.5em">')+('<div class="visible content">'+zeroBSCRMJS_transEditLang("view","View"))+'</div><div class="hidden content"><i class="icon file text"></i></div></div>',jQuery("#invoiceSelectionTitle").prepend(n),zeroBSCRMJS_bindInvLinkIf())}function zeroBSCRMJS_bindInvLinkIf(){jQuery("#invoiceSelectionTitle .zbs-view-invoice").off("click").on("click",function(){var n=parseInt(jQuery("#invoiceFieldWrap select").val()),n=window.zeroBSCRMJS_transactionedit_links.editinvprefix+n;window.open(n,"_parent")})}function zeroBSCRMJS_showContactLinkIf(n){var i;jQuery("#zbs-customer-title .zbs-view-contact").remove(),jQuery("#zbs-transaction-learn-nav .zbs-trans-quicknav-contact").remove(),null!=n&&""!==n&&0<(n=parseInt(n))&&(n=window.zbsObjectViewLinkPrefixCustomer+n,i=(i='<div class="ui right floated mini animated button zbs-view-contact">')+('<div class="visible content">'+zeroBSCRMJS_transEditLang("view","View"))+'</div><div class="hidden content"><i class="user icon"></i></div></div>',jQuery("#zbs-customer-title").prepend(i),i='<a target="_blank" style="margin-left:6px;" class="zbs-trans-quicknav-contact ui icon button blue mini labeled" href="'+n+'"><i class="user icon"></i> '+zeroBSCRMJS_transEditLang("contact","Contact")+"</a>",jQuery("#zbs-transaction-learn-nav").append(i),zeroBSCRMJS_bindContactLinkIf())}function zeroBSCRMJS_bindContactLinkIf(){jQuery("#zbs-customer-title .zbs-view-contact").off("click").on("click",function(){var n=parseInt(jQuery("#customer").val());null!=n&&""!==n&&0<(n=parseInt(n))&&(n=window.zbsObjectViewLinkPrefixCustomer+n,window.open(n,"_parent"))})}function zeroBSCRMJS_showCompanyLinkIf(n){var i;jQuery("#zbs-company-title .zbs-view-company").remove(),jQuery("#zbs-transaction-learn-nav .zbs-trans-quicknav-company").remove(),null!=n&&""!==n&&0<(n=parseInt(n))&&(i=(i='<div class="ui right floated mini animated button zbs-view-company">')+('<div class="visible content">'+zeroBSCRMJS_transEditLang("view","View"))+'</div><div class="hidden content"><i class="building icon"></i></div></div>',jQuery("#zbs-company-title").prepend(i),i='<a target="_blank" style="margin-left:6px;" class="zbs-trans-quicknav-company ui icon button blue mini labeled" href="'+window.zeroBSCRMJS_transactionedit_links.editcompanyprefix+n+'"><i class="building icon"></i> '+zeroBSCRMJS_transEditLang("company","Company")+"</a>",jQuery("#zbs-transaction-learn-nav").append(i),zeroBSCRMJS_bindCompanyLinkIf())}function zeroBSCRMJS_bindCompanyLinkIf(){jQuery("#zbs-company-title .zbs-view-company").off("click").on("click",function(){var n=parseInt(jQuery("#zbsct_company").val());null!=n&&""!==n&&0<(n=parseInt(n))&&(n=window.zeroBSCRMJS_transactionedit_links.editcompanyprefix+n,window.open(n,"_parent"))})}function zeroBSCRMJS_transEditLang(n,i){return void 0===i&&(i=""),void 0!==window.zeroBSCRMJS_transactionedit_lang[n]?window.zeroBSCRMJS_transactionedit_lang[n]:i}jQuery(function(){var n;jQuery("#customer").val()&&(n=!1,jQuery("#invoice_id").val()&&(n=jQuery("#invoice_id").val()),zbscrmjs_build_custInv_dropdown(jQuery("#customer").val(),n)),setTimeout(function(){zeroBSCRMJS_showInvLinkIf(),zeroBSCRMJS_showContactLinkIf(jQuery("#customer").val()),zeroBSCRMJS_showCompanyLinkIf(jQuery("#zbsct_company").val())},0)});