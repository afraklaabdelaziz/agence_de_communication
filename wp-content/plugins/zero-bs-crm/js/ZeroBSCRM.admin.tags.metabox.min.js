function zeroBSCRMJS_buildTags(){"object"==typeof window.zbsCRMJS_currentTags&&jQuery.each(window.zbsCRMJS_currentTags,function(a,t){void 0===window.zbsDontDrawTags&&zbsJS_drawTag(t,-1)}),setTimeout(function(){void 0===window.zbsCustomTagInitFunc?zbsJS_bindTagsInit():window[zbsCustomTagInitFunc]({})},0)}function zeroBSCRMJS_buildTagsInput(){var a=JSON.stringify(window.zbsCRMJS_currentTags);jQuery("#zbs-tag-list").val(a)}function zbsJS_drawTag(a,t){t='<div class="ui small basic label teal" data-id="'+t+'"><i class="window close icon zbs-remove-tag"></i> <span>'+a+"</span></div>";jQuery("#zbs-tags-wrap").append(t),setTimeout(function(){zbsJS_bindTags()},0)}function zbsJS_bindTags(){jQuery(".zbs-remove-tag").off("click").on("click",function(){var a=jQuery("span",jQuery(this).parent()).html(),a=window.zbsCRMJS_currentTags.indexOf(a);-1<a&&window.zbsCRMJS_currentTags.splice(a,1),jQuery(this).parent().remove(),zbscrm_JS_addDirty("zbs-tags")})}function zbsJS_bindTagsInit(){jQuery("#zbs-add-tag-action").off("click").on("click",function(){zbsJS_addTagAction(jQuery("#zbs-add-tag-value").val())}),jQuery("#zbs-add-tag-value").on("keypress",function(a){13==a.keyCode&&zbsJS_addTagAction(jQuery("#zbs-add-tag-value").val())}),jQuery("#zbs-tag-suggestions-show-more").off("click").on("click",function(){jQuery("#zbs-tag-suggestions-show-more").hide(),jQuery("#zbs-tag-suggestions-more-wrap").show()}),jQuery("#zbs-tag-suggestions-show-less").off("click").on("click",function(){jQuery("#zbs-tag-suggestions-show-more").show(),jQuery("#zbs-tag-suggestions-more-wrap").hide()}),jQuery(".zbsTagSuggestion").off("click").on("click",function(){zbsJS_addTagAction(jQuery(this).html())})}function zbsJS_addTagAction(a){""!=a&&-1==jQuery.inArray(a,window.zbsCRMJS_currentTags)&&(zbsJS_drawTag(a,-1),window.zbsCRMJS_currentTags.push(a),jQuery("#zbs-add-tag-value").val(""),zbscrm_JS_addDirty("zbs-tags"))}function zbsJS_bindTagManagerInit(){zeroBSCRMJS_tagManager_bindTagEditButtons(),jQuery("#zbs-add-tag-action").off("click").on("click",function(){var s=jQuery("#zbs-add-tag-value").val();""!=s&&-1==jQuery.inArray(s,window.zbsCRMJS_currentTags)?zbsJS_addEmptyTag(s,function(a){var t=s,e=-1,n=(void 0!==a.id&&(e=a.id),t),a=(void 0!==a.slug&&(n=a.slug),window.zbsCRMJS_currentTags.push(t),jQuery("#zbsNoTagResults").hide(),jQuery("#zbs-add-tag-value").val(""),'<tr><td><span class="ui large blue label">'+t+"</span></td><td>"+n+'</td><td class="center aligned">0</td><td class="center aligned"><button type="button" class="ui mini button orange zbs-delete-tag" data-tagid="'+e+'"><i class="trash alternate icon"></i> '+window.zbsTagListLang.delete+"</button></td></tr>");jQuery("#zbs-tag-manager tbody").append(a),setTimeout(function(){zeroBSCRMJS_tagManager_bindTagEditButtons()},0)},function(a){}):""==s?(jQuery("#zbsTagEmpty").show().css("margin-bottom","1em"),setTimeout(function(){jQuery("#zbsTagEmpty").hide()},4e3)):(jQuery("#zbsTagAlreadyExists").show().css("margin-bottom","1em"),setTimeout(function(){jQuery("#zbsTagAlreadyExists").hide()},4e3))}),jQuery("#zbs-add-tag-value").on("keypress",function(a){13==a.keyCode&&(jQuery("#zbs-add-tag-action").trigger("click"),a.preventDefault())})}jQuery(function(){});var zbsTagManagerUpdateAJAXBlocker=!1;function zbsJS_addEmptyTag(a,t,e){window.zbsTagManagerUpdateAJAXBlocker||(window.zbsTagManagerUpdateAJAXBlocker=!0,a={action:"zbs_add_tag",sec:window.zbscrmjs_secToken,objtype:window.zbsEditSettings.objdbname,tag:a},jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",timeout:2e4,success:function(a){"function"==typeof t&&t(a),window.zbsTagManagerUpdateAJAXBlocker=!1},error:function(a){"function"==typeof e&&e(a),window.zbsTagManagerUpdateAJAXBlocker=!1}}))}function zeroBSCRMJS_tagManager_bindTagEditButtons(){jQuery(".zbs-delete-tag").off("click").on("click",function(){var t=parseInt(jQuery(this).attr("data-tagid"));0<t&&swal({title:window.zbsTagListLang.deleteswaltitle,text:window.zbsTagListLang.deleteswaltext,type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:window.zbsTagListLang.deleteswalconfirm,allowOutsideClick:!1}).then(function(a){a.value&&(a={action:"zbs_delete_tag",tagid:t,sec:window.zbscrmjs_secToken},jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",timeout:2e4,success:function(a){swal(window.zbsTagListLang.tagdeleted,window.zbsTagListLang.tagremoved,"success"),location.reload()},error:function(a){swal(window.zbsTagListLang.tagnotdeleted,window.zbsTagListLang.tagnotremoved,"warning")}}))})})}