function jpcrm_woosync_initiate_sync(){jQuery("#jpcrm_failed_ajax").hide(),jQuery("#jpcrm_page_complete_ico").hide(),jQuery("#jpcrm_firing_ajax").addClass("active"),jpcrm_woosync_fire_sync(function(e){jQuery("#jpcrm_failed_ajax").hide();var r,o=1e3,n=!1,a=-1,c=-1;if(void 0!==e.status)switch(e.status){case"job_in_progress":void 0===window.jpcrm_woosync_sync_blocked_runs&&(window.jpcrm_woosync_sync_blocked_runs=0),window.jpcrm_woosync_sync_blocked_runs++,o=1e4;break;case"sync_part_complete":break;case"sync_completed":n=!0;break;case"error":var _=e.error_message;return jQuery("#jpcrm_firing_ajax").removeClass("active"),jQuery("#jpcrm_failed_ajax").show().attr("title",_),void jQuery("#jpcrm_failed_ajax span").text(_)}void 0!==e.remaining_pages&&(a=parseInt(e.remaining_pages)),void 0!==e.percentage_completed&&(c=e.percentage_completed),0==a||n?(jQuery("#jpcrm_firing_ajax").hide(),jQuery("#jpcrm_page_complete_ico").show(),window.location=window.jpcrm_woosync_post_completion_url):(r="",0<a&&(r=jpcrm_woosync_language_label("pages_remain","{0} pages remain").format(a)),0<c&&(r+=" ("+c+"%)"),""!==r&&jQuery("#jpcrm_firing_ajax").attr("title",r),void 0===window.jpcrm_woosync_sync_blocked_runs||window.jpcrm_woosync_sync_blocked_runs<10?(jQuery("#jpcrm_firing_ajax").hide(),jQuery("#jpcrm_page_complete_ico").show(),jpcrm_sleep(o),jpcrm_woosync_initiate_sync()):(_=jpcrm_woosync_language_label("caught_mid_job","Import job is running in the back end. If this message is still shown after some time, please contact support."),jQuery("#jpcrm_firing_ajax").removeClass("active"),jQuery("#jpcrm_failed_ajax").show().attr("title",_),jQuery("#jpcrm_failed_ajax span").text(_)))},function(e){var r="";if("timeout"==e.statusText)r=jpcrm_woosync_language_label("caught_mid_job","Import job is running in the back end. If this message is still shown after some time, please contact support.");else{if(0==e.status&&"error"==e.statusText)return;r=jpcrm_woosync_language_label("server_error","There was a general server error.")+" ("+e.status+")"}jQuery("#jpcrm_firing_ajax").removeClass("active"),jQuery("#jpcrm_failed_ajax").show().attr("title",r),jQuery("#jpcrm_failed_ajax span").text(r)})}function jpcrm_woosync_fire_sync(r,o){var e;window.jpcrm_woosync_firing_sync||(window.jpcrm_woosync_firing_sync=!0,e={action:"jpcrm_woosync_fire_sync_job",sec:window.jpcrm_woosync_nonce},jQuery.ajax({type:"POST",url:ajaxurl,data:e,dataType:"json",timeout:2e4,success:function(e){window.jpcrm_woosync_firing_sync=!1,"function"==typeof r&&r(e)},error:function(e){window.jpcrm_woosync_firing_sync=!1,"function"==typeof o&&o(e)}}))}function jpcrm_woosync_language_label(e,r){return void 0!==window.jpcrm_woosync_language_labels&&void 0!==window.jpcrm_woosync_language_labels[e]?window.jpcrm_woosync_language_labels[e]:void 0===r?"":r}jQuery(function(e){void 0!==window.jpcrm_woo_connect_initiate_ajax_sync&&jpcrm_woosync_initiate_sync(),jQuery(".jpcrm-clickable").on("click",function(){var e=jQuery(this).attr("data-href");e&&window.open(e,"_blank").trigger("focus")})}),String.prototype.format||(String.prototype.format=function(){var o=arguments;return this.replace(/{(\d+)}/g,function(e,r){return void 0!==o[r]?o[r]:e})});