!function(i,t){function e(){t.BaseGateway.call(this,wc_stripe_ach_params),t.CheckoutGateway.call(this),i(document.body).on("payment_method_selected",this.payment_method_selected.bind(this))}(e.prototype=i.extend({},t.BaseGateway.prototype,t.CheckoutGateway.prototype)).initialize=function(){i(document.body).on("click","#place_order",this.place_order.bind(this)),this.init_plaid()},e.prototype.init_plaid=function(){this.fetch_link_token().then(function(t){this.linkHandler=Plaid.create({clientName:this.params.client_name,env:this.params.env,product:["auth"],token:t,selectAccount:!0,countryCodes:["US"],onSuccess:function(t,e){this.payment_token_received=!0,this.set_nonce(t),this.set_metadata(e),this.fields.toFormFields(),i("#place_order").text(i("#place_order").data("value")),this.get_form().trigger("submit")}.bind(this),onExit:function(t,e){null!=t&&this.submit_error(t.error_message)}.bind(this)})}.bind(this))},e.prototype.place_order=function(t){this.is_gateway_selected()&&(this.payment_token_received||this.is_saved_method_selected()||(t.preventDefault(),this.linkHandler.open()))},e.prototype.hide_place_order=function(){},e.prototype.show_payment_button=function(){t.CheckoutGateway.prototype.show_place_order.apply(this,arguments)},e.prototype.set_metadata=function(t){this.fields.set(this.gateway_id+"_metadata",JSON.stringify(t))},e.prototype.fees_enabled=function(){return"1"==this.params.fees_enabled},e.prototype.payment_method_selected=function(){this.fees_enabled()&&i(document.body).trigger("update_checkout")},e.prototype.fetch_link_token=function(){return new Promise(function(e){i.post({url:this.params.routes.link_token,dataType:"json",data:{_wpnonce:this.params.rest_nonce}}).done(function(t){e(t.token)}.bind(this)).fail(function(t,e,n){i(this.container).hide(),console.log(n)}.bind(this))}.bind(this))},new e}(jQuery,window.wc_stripe);