{"version":3,"sources":["webpack://wc_stripe.[name]/./node_modules/@babel/runtime/helpers/asyncToGenerator.js","webpack://wc_stripe.[name]/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://wc_stripe.[name]/./node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack://wc_stripe.[name]/./node_modules/@babel/runtime/helpers/objectWithoutProperties.js","webpack://wc_stripe.[name]/./node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","webpack://wc_stripe.[name]/./node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack://wc_stripe.[name]/external \"jQuery\"","webpack://wc_stripe.[name]/external \"regeneratorRuntime\"","webpack://wc_stripe.[name]/external [\"wp\",\"apiFetch\"]","webpack://wc_stripe.[name]/webpack/bootstrap","webpack://wc_stripe.[name]/webpack/runtime/define property getters","webpack://wc_stripe.[name]/webpack/runtime/hasOwnProperty shorthand","webpack://wc_stripe.[name]/webpack/runtime/make namespace object","webpack://wc_stripe.[name]/./packages/cartflows/assets/js/index.js"],"names":["asyncGeneratorStep","gen","resolve","reject","_next","_throw","key","arg","info","value","error","done","Promise","then","module","exports","fn","self","this","args","arguments","apply","err","undefined","obj","Object","defineProperty","enumerable","configurable","writable","__esModule","objectWithoutPropertiesLoose","source","excluded","i","target","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","prototype","propertyIsEnumerable","call","sourceKeys","keys","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","initStripe","maybeStripe","startTime","stripe","_registerWrapper","name","version","registerWrapper","stripePromise$1","params","window","Stripe","console","warn","script","scripts","document","querySelectorAll","concat","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","loadCalled","loadStripe","_len","Array","_key","Date","now","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","d","definition","o","get","prop","hasOwnProperty","r","Symbol","toStringTag","currentButton","data","cartflows_offer","stripeData","getStripe","accountId","stripeAccount","catch","handleHashChange","e","match","newURL","JSON","parse","atob","decodeURIComponent","history","pushState","location","pathname","search","handleCardAction","client_secret","props","result","trigger","message","setTimeout","msg","timeout","syncPaymentIntent","triggerOfferClick","click","path","method","response","on","currentTarget"],"mappings":"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","file":"wc-stripe-cartflows.js","sourcesContent":["function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose\");\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutProperties;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nmodule.exports = _objectWithoutPropertiesLoose;","var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.12.1\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n};\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","module.exports = window[\"jQuery\"];","module.exports = window[\"regeneratorRuntime\"];","module.exports = window[\"wp\"][\"apiFetch\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import $ from 'jquery';\r\nimport {loadStripe} from '@stripe/stripe-js';\r\nimport apiFetch from \"@wordpress/api-fetch\";\r\n\r\nconst data = cartflows_offer.stripeData;\r\nconst getStripe = new Promise(resolve => {\r\n    loadStripe(data.key, (() => data.accountId ? {stripeAccount: data.accountId} : {})()).then(stripe => {\r\n        resolve(stripe);\r\n    }).catch(error => {\r\n        resolve(false);\r\n    })\r\n});\r\n\r\nlet currentButton;\r\n\r\nconst initialize = () => {\r\n    window.addEventListener('hashchange', handleHashChange);\r\n    $(document.body).on('click', 'a[href*=\"wcf-up-offer\"], a[href*=\"wcf-down-offer\"]', handleButtonClick);\r\n}\r\n\r\nconst handleButtonClick = (e) => {\r\n    currentButton = $(e.currentTarget);\r\n}\r\n\r\nconst handleHashChange = async (e) => {\r\n    var match = e.newURL.match(/response=(.*)/);\r\n    if (match) {\r\n        try {\r\n            var obj = JSON.parse(window.atob(decodeURIComponent(match[1])));\r\n            if (obj && obj.hasOwnProperty('client_secret')) {\r\n                history.pushState({}, '', window.location.pathname + window.location.search);\r\n                handleCardAction(obj);\r\n            }\r\n        } catch (err) {\r\n\r\n        }\r\n    }\r\n    return true;\r\n}\r\n\r\nconst handleCardAction = async ({client_secret, ...props}) => {\r\n    const stripe = await getStripe;\r\n    stripe.handleCardAction(client_secret).then(result => {\r\n        if (result.error) {\r\n            $('body').trigger('wcf-update-msg', [result.error.message, 'wcf-payment-error']);\r\n            setTimeout(() => {\r\n                $(document.body).trigger('wcf-hide-loader')\r\n                $(document.body).trigger('wcf-update-msg', [data.msg, 'wcf-payment-success']);\r\n            }, data.timeout);\r\n            syncPaymentIntent({client_secret, ...props});\r\n        } else {\r\n            triggerOfferClick();\r\n        }\r\n    })\r\n}\r\n\r\nconst triggerOfferClick = () => {\r\n    currentButton.click();\r\n}\r\n\r\nconst syncPaymentIntent = (data) => {\r\n    return new Promise((resolve, reject) => {\r\n        apiFetch({\r\n            path: '/wc-stripe/v1/cartflows/payment-intent',\r\n            method: 'POST',\r\n            data\r\n        }).then(response => {\r\n        }).catch(err => {\r\n        });\r\n    });\r\n}\r\n\r\ninitialize();"],"sourceRoot":""}