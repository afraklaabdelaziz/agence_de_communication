{"version":3,"sources":["webpack://wc_stripe.[name]/./packages/woofunnels/assets/js/upsell/index.js","webpack://wc_stripe.[name]/./node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack://wc_stripe.[name]/./node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack://wc_stripe.[name]/external \"jQuery\"","webpack://wc_stripe.[name]/webpack/bootstrap","webpack://wc_stripe.[name]/webpack/runtime/define property getters","webpack://wc_stripe.[name]/webpack/runtime/hasOwnProperty shorthand","webpack://wc_stripe.[name]/webpack/runtime/make namespace object"],"names":["stripe","data","onHandleSubmit","handleHashChange","addChargeData","getData","setData","resetPaymentProcess","module","exports","obj","__esModule","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","initStripe","maybeStripe","args","startTime","apply","undefined","_registerWrapper","name","version","registerWrapper","stripePromise$1","Promise","resolve","then","params","reject","window","Stripe","console","warn","script","scripts","document","querySelectorAll","concat","i","length","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","loadCalled","err","loadStripe","_len","arguments","Array","_key","Date","now","__webpack_module_cache__","__webpack_require__","moduleId","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","e","bucket","match","newURL","JSON","parse","atob","decodeURIComponent","swal","hide","payment_intent","history","pushState","location","pathname","search","confirmCardPayment","client_secret","response","sendBucket","catch","log","defaultValue","inOfferTransaction","EnableButtonState","HasEventRunning","on","wfocu_vars","stripeData","wfocuCommons","addFilter","stripeAccount","client"],"mappings":"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","file":"wc-stripe-woofunnels-upsell.js","sourcesContent":["import {loadStripe} from '@stripe/stripe-js';\r\nimport $ from 'jquery';\r\n\r\nlet stripe;\r\n\r\nlet data = {};\r\n\r\nconst initialize = () => {\r\n    $(document).on('wfocu_external', onHandleSubmit);\r\n    window.addEventListener('hashchange', handleHashChange);\r\n    wfocuCommons.addFilter('wfocu_front_charge_data', addChargeData);\r\n    loadStripe(getData('publishableKey', (() => {\r\n        if (getData('account')) {\r\n            return {stripeAccount: getData('account')};\r\n        }\r\n        return {};\r\n    })())).then((client) => {\r\n        stripe = client;\r\n    }).catch(error => {\r\n    });\r\n}\r\n\r\nconst onBucketCreated = (e, bucket) => {\r\n    data = window?.wfocu_vars?.stripeData;\r\n    setData('bucket', bucket);\r\n    initialize();\r\n}\r\n\r\nconst onHandleSubmit = (e, bucket) => {\r\n    setData('bucket', bucket);\r\n}\r\n\r\nconst handleHashChange = (e) => {\r\n    var match = e.newURL.match(/response=(.*)/);\r\n    if (match) {\r\n        const obj = JSON.parse(window.atob(decodeURIComponent(match[1])));\r\n        getData('bucket')?.swal?.hide();\r\n        setData('paymentIntent', obj.payment_intent);\r\n        history.pushState({}, '', window.location.pathname + window.location.search);\r\n        stripe.confirmCardPayment(obj.client_secret).then(response => {\r\n            if (response.error) {\r\n                // display message\r\n                resetPaymentProcess();\r\n            } else {\r\n                setData('paymentComplete', true);\r\n                getData('bucket').sendBucket();\r\n            }\r\n        }).catch(error => {\r\n            console.log(error);\r\n        });\r\n    }\r\n}\r\n\r\nconst addChargeData = (e) => {\r\n    e['_payment_intent'] = getData('paymentIntent');\r\n    return e;\r\n}\r\n\r\nconst getData = (key, defaultValue = null) => {\r\n    if (!data.hasOwnProperty(key)) {\r\n        data[key] = defaultValue;\r\n    }\r\n    return data[key];\r\n}\r\n\r\nconst setData = (key, value) => {\r\n    data[key] = value;\r\n}\r\n\r\nconst resetPaymentProcess = () => {\r\n    getData('bucket').inOfferTransaction = false;\r\n    getData('bucket').EnableButtonState();\r\n    getData('bucket').HasEventRunning = false;\r\n}\r\n\r\n$(document).on('wfocuBucketCreated', onBucketCreated);","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.12.1\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n};\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","module.exports = window[\"jQuery\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tif(__webpack_module_cache__[moduleId]) {\n\t\treturn __webpack_module_cache__[moduleId].exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"sourceRoot":""}